August 09th 2020

Started updating archiso to new pattern

Not sure if there is a replacement to customize_airootfs, may be better using run_before_mksquashfs

Noticed the existence of os-release and lsb-hooks still at airootfs files, removed, now needs testing.

August 12th 2020 (joekamprad)

* boot entries for EFI and syslinux added (working now)

* adding:
# Copy mkinitcpio archiso hooks and build initramfs (airootfs)
make_setup_mkinitcpio() {
    local _hook
    mkdir -p ${work_dir}/x86_64/airootfs/etc/initcpio/hooks
    mkdir -p ${work_dir}/x86_64/airootfs/etc/initcpio/install
    for _hook in archiso archiso_shutdown archiso_loop_mnt; do
        cp /usr/lib/initcpio/hooks/${_hook} ${work_dir}/x86_64/airootfs/etc/initcpio/hooks
        cp /usr/lib/initcpio/install/${_hook} ${work_dir}/x86_64/airootfs/etc/initcpio/install
    done
    sed -i "s|/usr/lib/initcpio/|/etc/initcpio/|g" ${work_dir}/x86_64/airootfs/etc/initcpio/install/archiso_shutdown
    cp /usr/lib/initcpio/install/archiso_kms ${work_dir}/x86_64/airootfs/etc/initcpio/install
    cp /usr/lib/initcpio/archiso_shutdown ${work_dir}/x86_64/airootfs/etc/initcpio
    cp ${script_path}/mkinitcpio.conf ${work_dir}/x86_64/airootfs/etc/mkinitcpio-archiso.conf
}
to build.sh

* removed mkinitcpio-archiso from packages.x86_64 (not needed on iso if initcpio folder is present inside airootfs folder)
---> copy initcpio folder to airootfs/etc/.


